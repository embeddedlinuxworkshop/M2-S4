# M2-S4

# Building File system and Booting Kernel.


## Contents:
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1. Kernel without File system.
2. Sending Filesystem to Kernel.
3. Defintion of Minimal rootfilesystem.
4. Content of Rootfilesystem.
5. `sudo` Permisions.
6. User space first process.
7. Programs and Utilities.
8. Libraries.
9. Merging `sysroot` with `rootfilesystem` using `rsync`
10. Virtual File systems [proc and sysfs].
11. Packaging rootfilesystem to target [initramfs - Disk Image - NFS].
12. Creating Uncompressed filesystem.
13. Compressing `initramfs` system using [mkinitfs - CPIO].
14. Booting Kernel with initramfs.
15. Init program [Process of reading configuration from /etc/inittab].
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 1. Kernel without filesystem ðŸ˜±ðŸ˜±ðŸ˜±ðŸ˜±ðŸ˜±ðŸ˜±ðŸ˜±ðŸ˜±ðŸ˜±ðŸ˜±ðŸ˜±
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

```
qemu-system-aarch64 -M virt -cpu cortex-a53 -m 1G -kernel Image  -append "console=ttyAMA0"  -nographic
```
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
### 2. How Filesystem should look like
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
```
man hier
```

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
### 3. Defintion of Minimal rootfilesystem.
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
a. standard directories.
```

\u251c\u2500\u2500 bin
\u251c\u2500\u2500 dev
\u251c\u2500\u2500 etc
\u251c\u2500\u2500 home
\u251c\u2500\u2500 lib
\u251c\u2500\u2500 lib64
\u251c\u2500\u2500 proc
\u251c\u2500\u2500 sbin
\u251c\u2500\u2500 sys
\u251c\u2500\u2500 tmp
\u251c\u2500\u2500 usr
\u2502\u00a0\u00a0 \u251c\u2500\u2500 bin
\u2502\u00a0\u00a0 \u251c\u2500\u2500 include
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 arpa
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 asm
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 asm-generic
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 bits
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 types
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 drm
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 finclude
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 gdb
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 gnu
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 linux
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 android
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 byteorder
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 caif
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 can
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cifs
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 dvb
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 genwqe
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 hdlc
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 hsi
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 iio
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 isdn
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 misc
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 mmc
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 netfilter
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 ipset
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 netfilter_arp
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 netfilter_bridge
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 netfilter_ipv4
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 netfilter_ipv6
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 nfsd
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 raid
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 sched
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 spi
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 sunrpc
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 surface_aggregator
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 tc_act
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 tc_ematch
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 usb
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 misc
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 uacce
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 mtd
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 net
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 netash
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 netatalk
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 netax25
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 neteconet
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 netinet
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 netipx
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 netiucv
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 netpacket
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 netrom
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 netrose
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 nfs
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 protocols
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 rdma
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 hfi
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 rpc
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 scsi
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 fc
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 sound
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 intel
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 avs
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 sof
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 sys
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 video
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 xen
\u2502\u00a0\u00a0 \u251c\u2500\u2500 lib
\u2502\u00a0\u00a0 \u251c\u2500\u2500 lib64
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 audit
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 gconv
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 gconv-modules.d
\u2502\u00a0\u00a0 \u251c\u2500\u2500 libexec
\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 getconf
\u2502\u00a0\u00a0 \u251c\u2500\u2500 sbin
\u2502\u00a0\u00a0 \u2514\u2500\u2500 share
\u2502\u00a0\u00a0     \u251c\u2500\u2500 i18n
\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 charmaps
\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 locales
\u2502\u00a0\u00a0     \u2514\u2500\u2500 locale
\u2502\u00a0\u00a0         \u251c\u2500\u2500 be
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 bg
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 ca
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 cs
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 da
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 de
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 el
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 en_GB
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 eo
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 es
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 fi
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 fr
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 gl
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 hr
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 hu
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 ia
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 id
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 it
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 ja
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 ka
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 ko
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 lt
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 nb
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 nl
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 pl
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 pt
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 pt_BR
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 ro
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 ru
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 rw
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 sk
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 sl
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 sr
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 sv
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 tr
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 uk
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 vi
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u251c\u2500\u2500 zh_CN
\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 LC_MESSAGES
\u2502\u00a0\u00a0         \u2514\u2500\u2500 zh_TW
\u2502\u00a0\u00a0             \u2514\u2500\u2500 LC_MESSAGES
\u2514\u2500\u2500 var
    \u251c\u2500\u2500 db
    \u2514\u2500\u2500 log


```
a. Init process.
b. Shell.
c. Commands.
d. Applications.

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


